<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>后台管理 - EJU 题库</title>
<style>
body { font-family: sans-serif; margin: 2rem; background-color: #f9fafb; color: #333; }
h1 { color: #007bff; }
nav a { margin-right: 1rem; text-decoration: none; color: #007bff; }
nav a.button {
  display: inline-block;
  padding: 0.5rem 1rem;
  background-color: #28a745;
  color: #fff;
  border-radius: 4px;
}
nav a.button:hover { background-color: #218838; }
table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
th, td { padding: 0.5rem; border: 1px solid #ddd; text-align: left; }
th { background-color: #f1f1f1; }
.actions a { margin-right: 0.5rem; text-decoration: none; color: #007bff; }
.flash { padding: 0.5rem; margin-bottom: 1rem; border-radius: 4px; }
.flash.error { background-color: #f8d7da; color: #842029; }
.flash.success { background-color: #d1e7dd; color: #0f5132; }
</style>
</head>
<body>
<h1>后台管理</h1>
<nav>
    <a href="{{ url_for('home') }}">返回首页</a>
    <a class="button" href="{{ url_for('add_question_get') }}">添加新题目</a>
    <a class="button" href="{{ url_for('quiz') }}">前往学生答题</a>
</nav>

{% if msg %}
<div class="flash {{ category }}">{{ msg }}</div>
{% endif %}

<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>题目</th>
            <th>标签</th>
            <th>板块</th>
            <th>正确答案</th>
            <th>操作</th>
        </tr>
    </thead>
    <tbody>
        {% for q in questions %}
        <tr>
            <td>{{ q['id'] }}</td>
            <td>{{ q['question']|truncate(60) }}</td>
            <td>{{ q['tags'] }}</td>
            <td>{{ q['section'] }}</td>
            <td>{{ q['correct_option'] }}</td>
            <td class="actions">
                <a href="{{ url_for('edit_question_get', qid=q['id']) }}">编辑</a>
                <a href="#" onclick="if(confirm('确认删除此题目？')){ document.getElementById('del-{{ q['id'] }}').submit(); } return false;">删除</a>
                <form id="del-{{ q['id'] }}" method="post" action="{{ url_for('delete_question', qid=q['id']) }}" style="display:none;"></form>
            </td>
        </tr>
        {% endfor %}
        {% if questions|length == 0 %}
        <tr><td colspan="6">没有题目。</td></tr>
        {% endif %}
    </tbody>
</table>
</body>
</html>